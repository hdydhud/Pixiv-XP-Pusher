# Pixiv XP Pusher 配置文件示例
# 请复制此文件为 config.yaml 并填入您的真实信息

pixiv:
  # Pixiv 刷新令牌 (通过 get_token.py 获取，或手动填入)
  refresh_token: "YOUR_REFRESH_TOKEN_HERE"
  
  # 您的 Pixiv 用户ID (自动获取，或手动指定)
  user_id: 0

profiler:
  # AI 标签分析配置
  ai:
    enabled: true
    # AI 提供商: openai / gemini / claude (目前主要支持 openai 格式)
    provider: "openai"
    # API 密钥
    api_key: "sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
    # API 基础地址 (如果使用中转服务)
    base_url: "https://api.openai.com/v1"
    # 模型名称
    model: "gpt-4o-mini"
    # 并发请求数 (建议 5-20)
    concurrency: 10

  # 标签画像配置
  scan_limit: 1000        # 扫描收藏数量上限
  discovery_rate: 0.1     # 探索新 Tag 的概率 (0.1 = 10%)
  time_decay_days: 180    # 时间衰减半衰期（天），权重随时间降低
  saturation_threshold: 0.5 # 高频 Tag 饱和度阈值 (0-1)，超过此比例自动过滤
  
  tags:
    # 过滤无意义标签
    filter_meaningless: true
    # 合并同义标签
    merge_synonyms: true
    # 额外黑名单 (不仅限于自动分析的)
    blacklist:
      - "R-18"
      - "R-18G"
    # 画像生成时保留权重最高的 N 个标签
    top_n: 20
    # 是否包含私密收藏用于分析
    include_private: true

scheduler:
  # 定时任务配置 (Cron 表达式: 分 时 日 月 周)
  # 示例: 每天中午 12:00 执行
  cron: "0 12 * * *"
  # 是否合并错过的任务
  coalesce: true
  # 每日维护任务时间 (日报 + 清理)
  daily_report_cron: "0 0 * * *"  # 默认每天 00:00

filter:
  daily_limit: 20         # 每日推送上限
  exclude_ai: true        # 过滤 AI 生成作品
  max_per_artist: 3       # 单画师最多推送数
  artist_boost: 0.3       # 订阅画师加成
  min_create_days: 30     # 过滤 N 天前的作品
  r18_mode: false         # 是否允许 R18 (需 Token 权限)

fetcher:
  bookmark_threshold:
    search: 1000          # 搜索结果的最低收藏数要求
  subscribed_artists: []  # 额外关注的画师 ID 列表
  
  # MAB 策略配额限制 (占比 0.0 - 1.0)
  mab_limits:
    # 至少保留 20% 给每个策略，防止饿死
    min_quota: 0.2
    # 任何单一策略最多占用 60%
    max_quota: 0.6

notifier:
  # 启用的推送通道列表: telegram, onebot
  types: [telegram]
  
  # 多图作品配置
  max_pages: 10         # 打包发送的最大页数，超过此项将仅发送封面 + 链接提示
  
  # Telegram Bot
  telegram:
    bot_token: "YOUR_BOT_TOKEN"
    # 推送目标 Chat ID (支持列表)
    chat_ids: 
      - 123456789
    # 话题 ID (可选，用于 Supergroup 话题)
    thread_id: null
    # 允许互动的用户 ID 列表 (安全设置)
    allowed_users:
      - 12345678
    # 代理地址 (可选，国内环境必需，如 http://127.0.0.1:7890)
    proxy_url: null
    # 图片压缩配置
    image_quality: 85         # JPEG 压缩质量 (50-100)，越低越小但越模糊
    max_image_size: 2000      # 图片最大边长 (px)，大于此值会缩放
    
    # Topic 智能分流 (可选，用于 Supergroup 话题自动分类)
    # topic_rules:
    #   default: null           # 默认 topic_id (null = 不使用 topic)
    #   r18: 12345              # R18 作品自动发送到此 topic
    #   wallpaper: 12346        # 风景作品发送到此 topic
    # topic_tag_mapping:        # 标签到分类的映射
    #   wallpaper: ["風景", "背景", "landscape", "scenery"]
      
  # OneBot / QQ
  onebot:
    ws_url: "ws://127.0.0.1:3001"
    private_id: 12345678      # 私聊目标 QQ
    group_id: null            # 群聊目标群号
    push_to_private: true
    push_to_group: false
    master_id: 12345678       # 主人 QQ (只有主人能使用指令)

# 反馈与权重配置
feedback:
  like_boost: 0.5             # 喜欢时权重增加量
  dislike_penalty: 0.3        # 不喜欢时权重减少量
  dislike_threshold: 3        # 累计不喜欢达到此次数时，提示建议屏蔽
  max_chain_depth: 3          # 连锁反应最大连击次数
  related_push_limit: 1       # 每次反馈触发关联推送的数量 (默认 1)
